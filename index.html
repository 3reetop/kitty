<!DOCTYPE html>
<html>
  <head>
    <title>Kitty! by 3reetop</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV" crossorigin="anonymous"></script>
    <script>
      window.onload = function() {
        var xhttp = new XMLHttpRequest();
        var xhttp2 = new XMLHttpRequest();
        xhttp.onreadystatechange = function() {
          if (xhttp.readyState == 1) {
            xhttp.setRequestHeader("Authorization", "ILoveYouKitty");
            xhttp.responseType = 'arraybuffer';
          } else if (xhttp.readyState == 4) {
            var theArray = new Uint8Array(xhttp.response);
            var i = theArray.length;
            var binaryString = new Array(i);
            while (i--) {
              binaryString[i] = String.fromCharCode(theArray[i]);
            }
            var data = binaryString.join('');
            var base_64 = window.btoa(data);
            document.getElementById("kittyILoveYou").src = "data:image/png;base64,"+base_64;
          }
        };
        xhttp2.onreadystatechange = function() {
          if (xhttp2.readyState == 1) {
            xhttp2.setRequestHeader("Authorization", "ILoveYouKitty");
            xhttp2.responseType = 'text';
          } else if (xhttp.readyState == 4) {
            if (xhttp2.status == 200) {
              document.getElementById("apiStatus").innerHTML = "<b>operational</b>";
            } else {
              document.getElementById("apiStatus").innerHTML = "<b>down</b>";
            }
        };
        xhttp.open("GET", "https://kitty.3reetop.tech", true);
        xhttp2.open("GET", "https://kitty.3reetop.tech/ping", true);
        xhttp.send();
        xhttp2.send();
      }
    </script>
  </head>
  <body>
    <div class="container-fluid">
      <h1 class="text-center">Kitty!</h1>
      <p class="text-center">by <a href="https://3reetop.tech">3reetop</a></p>
      <br>
      <p class="text-center">This is a web front-end to an API I built that returns random images of my pet cat! The API is coded in JavaScript and hosted on Cloudflare Workers, and this website is static and hosted on GitHub Pages! This site simply makes an HTTP GET request to the API anytime you refresh it.</p>
      <br>
      <div class="alert alert-danger" role="alert">
        <b>It may take a while for the image to load. This is because the API returns raw image data, and your browser needs to encode it to Base64 to render the image. Other times, the API might be down. If it doesn't load within 10 seconds, then the API is definitely down, so come back later!</b>
      </div>
      <br>
      <div class="alert alert-primary" role="alert">
        <p>The API is currently <p id="apiStatus"></p>.</p>
      </div>
      <div class="text-center">
        <img src="" id="kittyILoveYou" height="650" width = "650">
      </div>
      <br>
      <div class="text-center">
        <button type="button" class="btn btn-primary" onclick="window.location.reload();">Get another picture of Kitty!</button>
      </div>
      <br>
      <p class="text-center">Copyright 2020 <a href="https://3reetop.tech">Sanel Kukic</a>. All rights reserved.</p>
      <br>
    </div>
  </body>
</html>
